<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Robert Ness" />

<meta name="date" content="2019-07-30" />

<title>Modeling the MAPK pathway as a causal constraints model</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Modeling the MAPK pathway as a causal constraints model</h1>
<h4 class="author">Robert Ness</h4>
<h4 class="date">2019-07-30</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(ode2scm)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#&gt; Loading required package: deSolve</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt; Loading required package: smfsb</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#&gt; Loading required package: abind</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#&gt; Loading required package: parallel</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt; Loading required package: tibble</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; Loading required package: reticulate</span></a></code></pre></div>
<div id="introduction-to-the-mapk-signaling-pathwary" class="section level2">
<h2>Introduction to the MAPK signaling pathwary</h2>
<p>The <a href="https://en.wikipedia.org/wiki/MAPK/ERK_pathway">mitogen-activated protein kinase</a> (MAPK) pathway is important in many biological processes, such as determination of cell fate. It is a cascade of three proteins, a MAPK (aka Erk), a MAPK kinase (MAP2K, aka Mek), and a MAPK kinase kinase (MAP3K, aka Raf), represented with a causal diagram. <span class="math display">\[\begin{eqnarray}
&amp; \text{E1} \rightarrow \text{MAP3K} \rightarrow \text{MAP2K} \rightarrow \text{MAPK} &amp; \label{eq:MAPKdef}
\end{eqnarray}\]</span> Here E1 is an input signal to the pathway. The cascade relays the signal from one protein to the next by changing the count of proteins in an active state.</p>
</div>
<div id="the-biochemical-reactions" class="section level2">
<h2>The biochemical reactions</h2>
<p>A protein molecule is in an active state if it has one or more attached phosphoryl groups. Each arrow in  combines the reactions of the phosphorylation (i.e., activation) and dephosphorylation (i.e., desactivation). For example, <span class="math inline">\(\text{E1} \rightarrow \text{MAP3K}\)</span> combines two reactions <span class="math display">\[\begin{eqnarray}
\text{E1} + \text{MAP3K} \overset{v^{\text{act}}_{K3}}{\rightarrow} \text{E1} + \text{P-MAP3K} \ \mbox{and}\
\text{P-MAP3K} \overset{v^{\text{inh}}_{K3}}{\rightarrow} \text{MAP3K}
\end{eqnarray}\]</span></p>
<p>In the first reaction above, a particle of the input signal  binds (i.e., activates) a molecule of MAP3K to produce MAP3K with an attached phosphoryl. The rate parameter associated with this reaction is <span class="math inline">\(v^{\text{act}}\)</span>. In the second reaction, phosphorylated MAP3K loses its phosphoryl (i.e., deactivates), with the rate <span class="math inline">\(v^{\text{inh}}\)</span>. The remaining arrows between MAP3K and MAP2K, and between MAP2K and MAPK aggregate similar reactions and rate pairs. However, these reactions represent double-phosphorylations, i.e., they require two activation reactions to activate the protein. This results in a more nuanced dynamics.</p>
</div>
<div id="the-deterministic-mechanistic-model" class="section level2">
<h2>The deterministic mechanistic model</h2>
<p>Let <span class="math inline">\(\text{K3}(t)\)</span>, <span class="math inline">\(\text{K2}(t)\)</span> and <span class="math inline">\(\text{K}(t)\)</span> denote the counts of fully phosphorylated MAP3K, MAP2K, and MAPK at time <span class="math inline">\(t\)</span>. Since MAP2K and MAPK have to be double phosphorylated to be “on” or “active”, then <span class="math inline">\(\text{K2}(t)\)</span> and <span class="math inline">\(\text{K}(t)\)</span> represent counts of double phosphorylated proteins. Let <span class="math inline">\(T_{\text{K3}}\)</span>, <span class="math inline">\(T_{\text{K2}}\)</span>, and <span class="math inline">\(T_{\text{K}}\)</span> represent the total amount of each of the three proteins (unphosphorylated + single-phosphorylation + double-phosphorylation). Let <span class="math inline">\(E1\)</span> bet the total amount of input signal, which in this model we assume are constant in time.</p>
<p>We model the system as a set of ordinary differential equations <span class="math inline">\(\mathbb{M}\)</span>.</p>
<p><span class="math display">\[
\mathbb{M} =
\left\{\begin{matrix}
 \frac{\mathrm{d} \text{K3}}{\mathrm{d} t} =&amp;  v^{\text{act}}_{K3}\text{E1}(T_{\text{K3}}-\text{K3}(t)) - v^{\text{inh}}_{K3}\text{K3}(t)\\ 
 \frac{\mathrm{d} \text{K2}}{\mathrm{d} t} =&amp;  \frac{(v^{\text{act}}_{K2})^2}{v^{\text{inh}}_{K2}}\text{K3}(t)^2(T_{\text{K2}} - \text{K2}(t)) - v^{\text{act}}_{K2}\text{K3}(t)\text{K2}(t) - v^{\text{inh}}_{K2}\text{K2}(t)\\ 
 \frac{\mathrm{d} \text{K1}}{\mathrm{d} t} =&amp;  \frac{(v^{\text{act}}_{K1})^2}{v^{\text{inh}}_{K1}}\text{K2}(t)^2(T_{\text{K1}} - \text{K1}(t)) - v^{\text{act}}_{K1}\text{K2}(t)\text{K1}(t) - v^{\text{inh}}_{K1}\text{K1}(t)
\end{matrix}\right.
\]</span></p>
</div>
<div id="building-a-deterministic-steady-state-model" class="section level2">
<h2>Building a deterministic steady state model</h2>
<p>Let <span class="math inline">\(\text{equil}()\)</span> be an operator that solves and equilbrates the model. Then:</p>
<p><span class="math display">\[
\text{equil}(\mathbb{M}) = 
\left\{\begin{matrix}
 \text{K3}=&amp;  T_{\text{K3}}g_1(\omega_{K3}\text{E1})\\ 
 \text{K2}=&amp;  T_{\text{K2}}g_2(\omega_{K2}\text{K3}) \\ 
 \text{K1}=&amp;  T_{\text{K1}}g_2(\omega_{K1}\text{K2})
\end{matrix}\right.
\]</span></p>
<p>where <span class="math inline">\(\text{K}3\)</span>, <span class="math inline">\(\text{K}2\)</span>, and <span class="math inline">\(\text{K}1\)</span> are the equilibrium values of <span class="math inline">\(\text{K}3(t)\)</span>, <span class="math inline">\(\text{K}2(t)\)</span>, and <span class="math inline">\(\text{K}1(t)\)</span>, no longer depending on time. <span class="math inline">\(g_1(u) = \frac{u}{1+u}\)</span>, <span class="math inline">\(g_2(u) = \frac{u^2}{1 + u + u^2}\)</span> and <span class="math inline">\(\omega_X = \frac{v^{\text{act}}_{X}}{v^{\text{inh}}_{X}}\)</span>.</p>
</div>
<div id="simulating-from-the-model" class="section level2">
<h2>Simulating from the model</h2>
<p>This packages contains a function for simulating from <span class="math inline">\(\mathbb{M}\)</span> in the directory <code>R/mapk.R</code> called <code>mapk_ode</code>. <code>mapk_ode</code> is a function takes a set of rate values and initial conditions as arguments and returns a new function that can be passed to <code>ode_sim</code>. <code>ode_sim</code> is just a wrapper for the <code>deSolve::ode</code> function for numerically solving ODE’s in R. <code>mapk_ode</code> works as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">rates &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="dt">raf_activate=</span><span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="dt">raf_deactivate=</span><span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="dt">mek_activate=</span><span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb2-5" title="5">  <span class="dt">mek_deactivate=</span><span class="fl">2.0</span>,</a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="dt">erk_activate=</span><span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="dt">erk_deactivate=</span><span class="fl">1.0</span></a>
<a class="sourceLine" id="cb2-8" title="8">)</a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10">initial_states &lt;-<span class="st">  </span><span class="kw">list</span>(<span class="dt">E1=</span><span class="dv">1</span>, <span class="dt">Raf=</span><span class="dv">80</span>, <span class="dt">PRaf=</span><span class="dv">20</span>, <span class="dt">Mek=</span><span class="dv">100</span>, <span class="dt">PMek=</span><span class="dv">0</span>, <span class="dt">PPMek=</span><span class="dv">0</span>, <span class="dt">Erk=</span><span class="dv">100</span>, <span class="dt">PErk=</span><span class="dv">0</span>, <span class="dt">PPErk=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-11" title="11"></a>
<a class="sourceLine" id="cb2-12" title="12">times &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">120</span>, <span class="dt">by =</span> <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14">mapk_ode_instance &lt;-<span class="st"> </span><span class="kw">mapk_ode</span>(initial_states, rates)</a>
<a class="sourceLine" id="cb2-15" title="15">ode_out &lt;-<span class="st"> </span><span class="kw">ode_sim</span>(mapk_ode_instance, initial_states, times)</a></code></pre></div>
<p>For comparison, the following code generates values according to the equilibrium solution.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">g1 &lt;-<span class="st"> </span><span class="cf">function</span>(a) a <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>a )</a>
<a class="sourceLine" id="cb3-2" title="2">g2 &lt;-<span class="st"> </span><span class="cf">function</span>(a) a<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># Totals depends on initial states, total Raf is Raf + PRaf, total Mek is Mek + PMek + PPMek, etc</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co"># Writing out explicitly to keep things simple.</span></a>
<a class="sourceLine" id="cb3-6" title="6">totals &lt;-<span class="st"> </span><span class="kw">with</span>(initial_states, {</a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="kw">list</span>(<span class="dt">Raf=</span>Raf<span class="op">+</span>PRaf, <span class="dt">Mek=</span>Mek <span class="op">+</span><span class="st"> </span>PMek <span class="op">+</span><span class="st"> </span>PPMek, <span class="dt">Erk=</span>Erk <span class="op">+</span><span class="st"> </span>PErk <span class="op">+</span><span class="st"> </span>PPErk)</a>
<a class="sourceLine" id="cb3-8" title="8">})</a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10">E1 &lt;-<span class="st"> </span>initial_states<span class="op">$</span>E1</a>
<a class="sourceLine" id="cb3-11" title="11">Raf &lt;-<span class="st"> </span>totals<span class="op">$</span>Raf <span class="op">*</span><span class="st"> </span><span class="kw">g1</span>(E1 <span class="op">*</span><span class="st"> </span>rates<span class="op">$</span>raf_activate <span class="op">/</span><span class="st"> </span>rates<span class="op">$</span>raf_deactivate)</a>
<a class="sourceLine" id="cb3-12" title="12">Mek &lt;-<span class="st"> </span>totals<span class="op">$</span>Mek <span class="op">*</span><span class="st"> </span><span class="kw">g2</span>(Raf <span class="op">*</span><span class="st"> </span>rates<span class="op">$</span>mek_activate <span class="op">/</span><span class="st"> </span>rates<span class="op">$</span>mek_deactivate)</a>
<a class="sourceLine" id="cb3-13" title="13">Erk &lt;-<span class="st"> </span>totals<span class="op">$</span>Erk <span class="op">*</span><span class="st"> </span><span class="kw">g2</span>(Mek <span class="op">*</span><span class="st"> </span>rates<span class="op">$</span>erk_activate <span class="op">/</span><span class="st"> </span>rates<span class="op">$</span>erk_deactivate)</a>
<a class="sourceLine" id="cb3-14" title="14"></a>
<a class="sourceLine" id="cb3-15" title="15">steady_states &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">Raf=</span>Raf, <span class="dt">Mek=</span>Mek, <span class="dt">Erk=</span>Erk)</a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">##</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co"># (mapk_ode_simplified, initial_states, PPMek = k) </span></a>
<a class="sourceLine" id="cb4-4" title="4">mapk_ode_simplified &lt;-<span class="st"> </span><span class="cf">function</span>(states, rates) {</a>
<a class="sourceLine" id="cb4-5" title="5">  transition_function &lt;-<span class="st"> </span><span class="cf">function</span>(t, states, rates) {</a>
<a class="sourceLine" id="cb4-6" title="6">    <span class="kw">with</span>(<span class="kw">as.list</span>(<span class="kw">c</span>(states, rates)), {</a>
<a class="sourceLine" id="cb4-7" title="7">      dE1 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb4-8" title="8">      dPRaf &lt;-<span class="st"> </span>raf_activate <span class="op">*</span><span class="st"> </span>Raf <span class="op">*</span><span class="st"> </span>E1 <span class="op">-</span><span class="st"> </span>raf_deactivate <span class="op">*</span><span class="st"> </span>PRaf</a>
<a class="sourceLine" id="cb4-9" title="9">      dPPMek &lt;-<span class="st"> </span>(mek_activate <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(PRaf <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(Mek <span class="op">+</span><span class="st"> </span>PMek) <span class="op">/</span><span class="st"> </span>mek_deactivate <span class="op">-</span><span class="st"> </span>mek_activate <span class="op">*</span><span class="st"> </span>PRaf <span class="op">*</span><span class="st"> </span>PPMek <span class="op">-</span><span class="st"> </span>mek_deactivate <span class="op">*</span><span class="st"> </span>PPMek</a>
<a class="sourceLine" id="cb4-10" title="10">      <span class="co"># dPPMek &lt;- 0</span></a>
<a class="sourceLine" id="cb4-11" title="11">      dPPErk &lt;-<span class="st"> </span>(erk_activate <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(PPMek <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(Erk <span class="op">+</span><span class="st"> </span>PErk) <span class="op">/</span><span class="st"> </span>erk_deactivate <span class="op">-</span><span class="st"> </span>erk_activate <span class="op">*</span><span class="st"> </span>PPMek <span class="op">*</span><span class="st"> </span>PPErk <span class="op">-</span><span class="st"> </span>erk_deactivate <span class="op">*</span><span class="st"> </span>PPErk</a>
<a class="sourceLine" id="cb4-12" title="12">    })</a>
<a class="sourceLine" id="cb4-13" title="13">  }</a>
<a class="sourceLine" id="cb4-14" title="14">}</a>
<a class="sourceLine" id="cb4-15" title="15"></a>
<a class="sourceLine" id="cb4-16" title="16"></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">##</span></a>
<a class="sourceLine" id="cb4-18" title="18">mapk_ode_intervention &lt;-<span class="st"> </span><span class="cf">function</span>(states, rates) {</a>
<a class="sourceLine" id="cb4-19" title="19">  transition_function &lt;-<span class="st"> </span><span class="cf">function</span>(t, states, rates) {</a>
<a class="sourceLine" id="cb4-20" title="20">    <span class="kw">with</span>(<span class="kw">as.list</span>(<span class="kw">c</span>(states, rates)), {</a>
<a class="sourceLine" id="cb4-21" title="21">      dE1 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb4-22" title="22">      dRaf &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb4-23" title="23">      dPRaf &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb4-24" title="24">      dMek &lt;-<span class="st"> </span><span class="op">-</span>mek_activate <span class="op">*</span><span class="st"> </span>Mek <span class="op">*</span><span class="st"> </span>PRaf <span class="op">+</span><span class="st"> </span>mek_deactivate <span class="op">*</span><span class="st"> </span>PMek</a>
<a class="sourceLine" id="cb4-25" title="25">      dPMek &lt;-<span class="st"> </span>mek_activate <span class="op">*</span><span class="st"> </span>Mek <span class="op">*</span><span class="st"> </span>PRaf <span class="op">+</span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="st">        </span>mek_deactivate <span class="op">*</span><span class="st"> </span>PPMek <span class="op">-</span></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="st">        </span>mek_deactivate <span class="op">*</span><span class="st"> </span>PMek <span class="op">-</span></a>
<a class="sourceLine" id="cb4-28" title="28"><span class="st">        </span>mek_activate <span class="op">*</span><span class="st"> </span>PMek <span class="op">*</span><span class="st"> </span>PRaf</a>
<a class="sourceLine" id="cb4-29" title="29">      dPPMek &lt;-<span class="st"> </span>mek_activate <span class="op">*</span><span class="st"> </span>PMek <span class="op">*</span><span class="st"> </span>PRaf <span class="op">-</span><span class="st"> </span>mek_deactivate <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-30" title="30"><span class="st">                </span>PPMek</a>
<a class="sourceLine" id="cb4-31" title="31">      dErk &lt;-<span class="st"> </span><span class="op">-</span>erk_activate <span class="op">*</span><span class="st"> </span>Erk <span class="op">*</span><span class="st"> </span>PPMek <span class="op">+</span><span class="st"> </span>erk_deactivate <span class="op">*</span><span class="st"> </span>PErk</a>
<a class="sourceLine" id="cb4-32" title="32">      dPErk &lt;-<span class="st"> </span>erk_activate <span class="op">*</span><span class="st"> </span>Erk <span class="op">*</span><span class="st"> </span>PPMek <span class="op">+</span></a>
<a class="sourceLine" id="cb4-33" title="33"><span class="st">        </span>erk_deactivate <span class="op">*</span><span class="st"> </span>PPErk <span class="op">-</span></a>
<a class="sourceLine" id="cb4-34" title="34"><span class="st">        </span>erk_deactivate <span class="op">*</span><span class="st"> </span>PErk <span class="op">-</span></a>
<a class="sourceLine" id="cb4-35" title="35"><span class="st">        </span>erk_activate <span class="op">*</span><span class="st"> </span>PErk <span class="op">*</span><span class="st"> </span>PPMek</a>
<a class="sourceLine" id="cb4-36" title="36">      dPPErk &lt;-<span class="st"> </span>erk_activate <span class="op">*</span><span class="st"> </span>PErk <span class="op">*</span><span class="st"> </span>PPMek <span class="op">-</span><span class="st"> </span>erk_deactivate <span class="op">*</span><span class="st"> </span>PPErk</a>
<a class="sourceLine" id="cb4-37" title="37">      </a>
<a class="sourceLine" id="cb4-38" title="38">      <span class="kw">list</span>(<span class="kw">c</span>(dE1, dRaf, dPRaf, dMek, dPMek, dPPMek, dErk, dPErk, dPPErk))</a>
<a class="sourceLine" id="cb4-39" title="39">    })</a>
<a class="sourceLine" id="cb4-40" title="40">  }</a>
<a class="sourceLine" id="cb4-41" title="41">  <span class="kw">attr</span>(transition_function, <span class="st">&#39;rates&#39;</span>) &lt;-<span class="st"> </span>rates</a>
<a class="sourceLine" id="cb4-42" title="42">  <span class="kw">return</span>(transition_function)</a>
<a class="sourceLine" id="cb4-43" title="43">}</a>
<a class="sourceLine" id="cb4-44" title="44"></a>
<a class="sourceLine" id="cb4-45" title="45">mapk_ode_intervention_instance &lt;-<span class="st"> </span><span class="kw">mapk_ode_intervention</span>(initial_states, rates)</a>
<a class="sourceLine" id="cb4-46" title="46">ode_out_intervention &lt;-<span class="st"> </span><span class="kw">ode_sim</span>(mapk_ode_intervention_instance, initial_states, times)</a>
<a class="sourceLine" id="cb4-47" title="47"><span class="co"># 120.0 1   Raf=80  PRaf=20 Mek=33.33333    PMek=33.33333   PPMek=33.33333  Erk=6.47482 PErk=21.58273   PPErk=71.94245</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">equilibrium &lt;-<span class="st"> </span><span class="cf">function</span>(initial_states) {</a>
<a class="sourceLine" id="cb5-2" title="2">  totals &lt;-<span class="st"> </span><span class="kw">with</span>(initial_states, {</a>
<a class="sourceLine" id="cb5-3" title="3">    <span class="kw">list</span>(<span class="dt">Raf=</span>Raf<span class="op">+</span>PRaf, <span class="dt">Mek=</span>Mek <span class="op">+</span><span class="st"> </span>PMek <span class="op">+</span><span class="st"> </span>PPMek, <span class="dt">Erk=</span>Erk <span class="op">+</span><span class="st"> </span>PErk <span class="op">+</span><span class="st"> </span>PPErk)</a>
<a class="sourceLine" id="cb5-4" title="4">  })</a>
<a class="sourceLine" id="cb5-5" title="5">  </a>
<a class="sourceLine" id="cb5-6" title="6">  E1 &lt;-<span class="st"> </span>initial_states<span class="op">$</span>E1</a>
<a class="sourceLine" id="cb5-7" title="7">  Raf &lt;-<span class="st"> </span>totals<span class="op">$</span>Raf <span class="op">*</span><span class="st"> </span><span class="kw">g1</span>(E1 <span class="op">*</span><span class="st"> </span>rates<span class="op">$</span>raf_activate <span class="op">/</span><span class="st"> </span>rates<span class="op">$</span>raf_deactivate)</a>
<a class="sourceLine" id="cb5-8" title="8">  Mek &lt;-<span class="st"> </span>totals<span class="op">$</span>Mek <span class="op">*</span><span class="st"> </span><span class="kw">g2</span>(Raf <span class="op">*</span><span class="st"> </span>rates<span class="op">$</span>mek_activate <span class="op">/</span><span class="st"> </span>rates<span class="op">$</span>mek_deactivate)</a>
<a class="sourceLine" id="cb5-9" title="9">  Erk &lt;-<span class="st"> </span>totals<span class="op">$</span>Erk <span class="op">*</span><span class="st"> </span><span class="kw">g2</span>(Mek <span class="op">*</span><span class="st"> </span>rates<span class="op">$</span>erk_activate <span class="op">/</span><span class="st"> </span>rates<span class="op">$</span>erk_deactivate)</a>
<a class="sourceLine" id="cb5-10" title="10">  </a>
<a class="sourceLine" id="cb5-11" title="11">  steady_states &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">Raf=</span>Raf, <span class="dt">Mek=</span>Mek, <span class="dt">Erk=</span>Erk)</a>
<a class="sourceLine" id="cb5-12" title="12">  <span class="kw">return</span>(steady_states)</a>
<a class="sourceLine" id="cb5-13" title="13">}</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"></a>
<a class="sourceLine" id="cb6-2" title="2">steady_states_intervention &lt;-<span class="st"> </span><span class="kw">equilibrium</span>(initial_states)</a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co"># check against </span></a></code></pre></div>
<p>The trajectories (solid lines) represent the evolution of the amounts of MAP3K (green), MAP2K (blue), and MAPK (red) in time. The dashed lines are the calculated equilibrium values.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">plot</span>(times, ode_out_intervention<span class="op">$</span>PRaf, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;darkgreen&#39;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">110</span>), <span class="dt">ylab =</span> <span class="st">&#39;amount&#39;</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">lines</span>(ode_out_intervention<span class="op">$</span>PPMek, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;darkblue&#39;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">110</span>))</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">lines</span>(ode_out_intervention<span class="op">$</span>PPErk, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;darkred&#39;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">110</span>))</a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw">abline</span>(<span class="dt">h =</span> Raf, <span class="dt">col=</span><span class="st">&#39;darkgreen&#39;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-5" title="5"><span class="kw">abline</span>(<span class="dt">h =</span> Mek, <span class="dt">col=</span><span class="st">&#39;darkblue&#39;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-6" title="6"><span class="kw">abline</span>(<span class="dt">h =</span> Erk, <span class="dt">col=</span><span class="st">&#39;darkred&#39;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="todo-sara-taheri-thadryan-sweeney-yao-xiao-simulating-an-ideal-intervention" class="section level2">
<h2>TODO (Sara Taheri, Thadryan Sweeney, Yao Xiao) Simulating an ideal intervention</h2>
<p>We define an ideal intervention in a dynamic model the same as we would with a structural causal model. It fixes a protein count variable to a constant value that does not change in time. For example, the perfect intervention do(K2 = k) applied to <span class="math inline">\(\mathbb{M}\)</span> would modify the model as follows:</p>
<p><span class="math display">\[
\text{do}(\mathbb{M}, K2 := k) = 
\left\{\begin{matrix}
 \frac{\mathrm{d} \text{K3}}{\mathrm{d} t} =&amp;  v^{\text{act}}_{K3}\text{E1}(T_{\text{K3}}-\text{K3}(t)) - v^{\text{inh}}_{K3}\text{K3}(t)\\ 
 \frac{\mathrm{d} \text{K2}}{\mathrm{d} t} =&amp; 0\\ 
 \frac{\mathrm{d} \text{K1}}{\mathrm{d} t} =&amp;  \frac{(v^{\text{act}}_{K1})^2}{v^{\text{inh}}_{K1}}k^2(T_{\text{K1}} - \text{K1}(t)) - v^{\text{act}}_{K1}k\text{K1}(t) - v^{\text{inh}}_{K1}\text{K1}(t)
\end{matrix}\right.
\]</span></p>
<p>Create a Pyro like <code>do</code> operator that modifies the MAPK model to simulate a perfect intervention. I should take in <code>mapk_ode</code>, and a list of interventions. The names of the list should be the names of variables in the model. The values of the list should be intervention values. It should return a function as before. For example, it would modify the workflow shown above as follows:</p>
<pre><code>mapk_ode_instance &lt;- mapk_ode(initial_states, rates)
mapk_ode_intervention &lt;- do(mapk_ode_instance, list(PPMek = k))
ode_out &lt;- ode_sim(mapk_ode_intervention, initial_states, times)</code></pre>
<p>Here “PPMek” is the same as <span class="math inline">\(K2(t)\)</span>, it is how double phosphorylated MAPK2 is specified in the model code.</p>
<p>Confirm your results work using the plotting method above. Vary the rates and the initial values, and generate plots like the one above. Verify in these plots that <span class="math inline">\(\text{equil}(\text{do}(\mathbb{M}, X = x)) == \text{do}(\text{equil}(\mathbb{M}, X = x))\)</span>.</p>
<p>The paper on <a href="https://arxiv.org/pdf/1805.06539.pdf">Causal Constraints Models</a> shows that in general <span class="math inline">\(\text{equil}(\text{do}(\mathbb{M}, X = x)) \neq \text{do}(\text{equil}(\mathbb{M}, X = x))\)</span>. So if your model is working for some conditions but not others, this is to be expected. Document those conditions for this model, and eventually you will compare them againt the causal constraint model for MAPK that your classmates will derive in the next section.</p>
<p>For starters, just get this working on <code>mapk_ode</code>. However, going forward you will to adapt this code to work on other models specified in this package. So if there are straightforward abstractions that will help your changes generalize and it is easy to implement them now, then do so.</p>
<p>Changing code based on variables and arguments is <a href="http://adv-r.had.co.nz/">metaprogramming</a>. To learn more, see the chapter on metaprogramming from the Advanced R book.</p>
</div>
<div id="todo-liang-xue-jiaxuan-wu-deriving-a-causal-constraints-model" class="section level2">
<h2>TODO (Liang Xue, Jiaxuan Wu) Deriving a causal constraints model</h2>
<p>Given the steady-state <span class="math inline">\(\text{equil}(\mathbb{M})\)</span>, we would ideally like to specify this as a causal model and begin reasoning on it in terms of interventions. However, the causal constraints paper shows that in general <span class="math inline">\(\text{equil}(\text{do}(\mathbb{M}, X = x)) \neq \text{do}(\text{equil}(\mathbb{M}, X = x))\)</span> (see Theorem 1).</p>
<div id="what-is-a-causal-constraints-model" class="section level3">
<h3>What is a causal constraints model?</h3>
<p>We have seen that an SCM starts with a set of endogenous variables connected by a directed graph. The endogenous variables are associated with exogenous noise variables.</p>
<p>Each endogenous variable has a structural assignment function that deterministically sets the endogenous variable’s value given input values fron its parent endogenous variable in the graph, and its corresponding noise variables.</p>
<p>In a SCM, this set of structural assignments constrain the solutions of the model in the absence of interventions. When there is an intervention, a structual assignment of the target variables are just changed or replaced with a constant, further constraining the solution space.</p>
<p>A causal constraints model (CCM) has the same set of endogenous and exogenous variables. But it replaces the set of structural assignments with a set of <em>causal constraints</em>. A causal constraint is a triple containing:</p>
<ol style="list-style-type: decimal">
<li>A structural assignment function <span class="math inline">\(f\)</span></li>
<li>A value in the image of <span class="math inline">\(f\)</span> (zero for observations, non-zero for interventions)</li>
<li>A set of intervention targets for which the constraint is active.</li>
</ol>
<p><strong>Write the steady-state state solution of the MAPK model as a CCM.</strong></p>
<p>Advice: Reread the multilayer perceptron example from Uri Alon’s Introduction to Systems Biology. MAPK is a signal transduction pathway, and this example concerns signaling transduction pathways and uses the same math. Also work through the math for deriving the steady state solution in the appendix. Once you are familiar with this, work through the biochemical reaction network example in the CCM paper.</p>
</div>
</div>
<div id="relating-pending-todos" class="section level2">
<h2>Relating pending TODOs</h2>
<p>The rest of the course project will flow from this work. It will include comparing results between groups to make sure they are consistent, implementing this MAPK model well as a more complex model as a CCM, and extending the modeling to stochastic settings.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
